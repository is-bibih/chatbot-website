{"remainingRequest":"/home/vivi/gits/COVID-19/public/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/vivi/gits/COVID-19/public/node_modules/vue-json-excel/JsonExcel.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/vivi/gits/COVID-19/public/node_modules/vue-json-excel/JsonExcel.vue","mtime":499162500000},{"path":"/home/vivi/gits/COVID-19/public/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vivi/gits/COVID-19/public/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/home/vivi/gits/COVID-19/public/node_modules/vuetify-loader/lib/loader.js","mtime":1574476662000},{"path":"/home/vivi/gits/COVID-19/public/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/vivi/gits/COVID-19/public/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgZG93bmxvYWQgZnJvbSAiZG93bmxvYWRqcyI7DQoNCmV4cG9ydCBkZWZhdWx0IHsNCiAgcHJvcHM6IHsNCiAgICAvLyBtaW1lIHR5cGUgW3hscywgY3N2XQ0KICAgIHR5cGU6IHsNCiAgICAgIHR5cGU6IFN0cmluZywNCiAgICAgIGRlZmF1bHQ6ICJ4bHMiDQogICAgfSwNCiAgICAvLyBKc29uIHRvIGRvd25sb2FkDQogICAgZGF0YTogew0KICAgICAgdHlwZTogQXJyYXksDQogICAgICByZXF1aXJlZDogZmFsc2UsDQogICAgICBkZWZhdWx0OiBudWxsDQogICAgfSwNCiAgICAvLyBmaWVsZHMgaW5zaWRlIHRoZSBKc29uIE9iamVjdCB0aGF0IHlvdSB3YW50IHRvIGV4cG9ydA0KICAgIC8vIGlmIG5vIGdpdmVuLCBhbGwgdGhlIHByb3BlcnRpZXMgaW4gdGhlIEpzb24gYXJlIGV4cG9ydGVkDQogICAgZmllbGRzOiB7DQogICAgICB0eXBlOiBPYmplY3QsDQogICAgICByZXF1aXJlZDogZmFsc2UNCiAgICB9LA0KICAgIC8vIHRoaXMgcHJvcCBpcyB1c2VkIHRvIGZpeCB0aGUgcHJvYmxlbSB3aXRoIG90aGVyIGNvbXBvbmVudHMgdGhhdCB1c2UgdGhlDQogICAgLy8gdmFyaWFibGUgZmllbGRzLCBsaWtlIHZlZS12YWxpZGF0ZS4gZXhwb3J0RmllbGRzIHdvcmtzIGV4YWN0bHkgbGlrZSBmaWVsZHMNCiAgICBleHBvcnRGaWVsZHM6IHsNCiAgICAgIHR5cGU6IE9iamVjdCwNCiAgICAgIHJlcXVpcmVkOiBmYWxzZQ0KICAgIH0sDQogICAgLy8gVXNlIGFzIGZhbGxiYWNrIHdoZW4gdGhlIHJvdyBoYXMgbm8gZmllbGQgdmFsdWVzDQogICAgZGVmYXVsdFZhbHVlOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICByZXF1aXJlZDogZmFsc2UsDQogICAgICBkZWZhdWx0OiAiIg0KICAgIH0sDQogICAgLy8gVGl0bGUocykgZm9yIHRoZSBkYXRhLCBjb3VsZCBiZSBhIHN0cmluZyBvciBhbiBhcnJheSBvZiBzdHJpbmdzIChtdWx0aXBsZSB0aXRsZXMpDQogICAgdGl0bGU6IHsNCiAgICAgIGRlZmF1bHQ6IG51bGwNCiAgICB9LA0KICAgIC8vIEZvb3RlcihzKSBmb3IgdGhlIGRhdGEsIGNvdWxkIGJlIGEgc3RyaW5nIG9yIGFuIGFycmF5IG9mIHN0cmluZ3MgKG11bHRpcGxlIGZvb3RlcnMpDQogICAgZm9vdGVyOiB7DQogICAgICBkZWZhdWx0OiBudWxsDQogICAgfSwNCiAgICAvLyBmaWxlbmFtZSB0byBleHBvcnQNCiAgICBuYW1lOiB7DQogICAgICB0eXBlOiBTdHJpbmcsDQogICAgICBkZWZhdWx0OiAiZGF0YS54bHMiDQogICAgfSwNCiAgICBmZXRjaDogew0KICAgICAgdHlwZTogRnVuY3Rpb24sDQogICAgfSwNCiAgICBtZXRhOiB7DQogICAgICB0eXBlOiBBcnJheSwNCiAgICAgIGRlZmF1bHQ6ICgpID0+IFtdDQogICAgfSwgDQogICAgd29ya3NoZWV0OiB7DQogICAgICB0eXBlOiBTdHJpbmcsIA0KICAgICAgZGVmYXVsdDogIlNoZWV0MSINCiAgICB9LA0KICAgIC8vZXZlbnQgYmVmb3JlIGdlbmVyYXRlIHdhcyBjYWxsZWQNCiAgICBiZWZvcmVHZW5lcmF0ZTp7DQogICAgICB0eXBlOiBGdW5jdGlvbiwNCiAgICB9LA0KICAgIC8vZXZlbnQgYmVmb3JlIGRvd25sb2FkIHBvcHMgdXANCiAgICBiZWZvcmVGaW5pc2g6ew0KICAgICAgdHlwZTogRnVuY3Rpb24sDQogICAgfSwNCiAgfSwNCiAgY29tcHV0ZWQ6IHsNCiAgICAvLyB1bmlxdWUgaWRlbnRpZmllcg0KICAgIGlkTmFtZSgpIHsNCiAgICAgIHZhciBub3cgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTsNCiAgICAgIHJldHVybiAiZXhwb3J0XyIgKyBub3c7DQogICAgfSwNCg0KICAgIGRvd25sb2FkRmllbGRzKCkgew0KICAgICAgaWYgKHRoaXMuZmllbGRzICE9PSB1bmRlZmluZWQpIHJldHVybiB0aGlzLmZpZWxkczsNCg0KICAgICAgaWYgKHRoaXMuZXhwb3J0RmllbGRzICE9PSB1bmRlZmluZWQpIHJldHVybiB0aGlzLmV4cG9ydEZpZWxkczsNCiAgICB9DQogIH0sDQogIG1ldGhvZHM6IHsNCiAgICBhc3luYyBnZW5lcmF0ZSgpIHsNCiAgICAgIGlmKHR5cGVvZiB0aGlzLmJlZm9yZUdlbmVyYXRlID09PSAnZnVuY3Rpb24nKXsNCiAgICAgICAgYXdhaXQgdGhpcy5iZWZvcmVHZW5lcmF0ZSgpOw0KICAgICAgfQ0KICAgICAgbGV0IGRhdGEgPSB0aGlzLmRhdGE7DQogICAgICBpZih0eXBlb2YgdGhpcy5mZXRjaCA9PT0gJ2Z1bmN0aW9uJyB8fCAhZGF0YSkNCiAgICAgICAgIGRhdGEgPSBhd2FpdCB0aGlzLmZldGNoKCk7DQoNCiAgICAgIGlmICghZGF0YSB8fCAhZGF0YS5sZW5ndGgpIHsNCiAgICAgICAgcmV0dXJuOw0KICAgICAgfQ0KDQogICAgICBsZXQganNvbiA9IHRoaXMuZ2V0UHJvY2Vzc2VkSnNvbihkYXRhLCB0aGlzLmRvd25sb2FkRmllbGRzKTsNCiAgICAgIGlmICh0aGlzLnR5cGUgPT09ICJodG1sIikgew0KICAgICAgICAvLyB0aGlzIGlzIG1haW5seSBmb3IgdGVzdGluZw0KICAgICAgICByZXR1cm4gdGhpcy5leHBvcnQoDQogICAgICAgICAgdGhpcy5qc29uVG9YTFMoanNvbiksDQogICAgICAgICAgdGhpcy5uYW1lLnJlcGxhY2UoIi54bHMiLCAiLmh0bWwiKSwNCiAgICAgICAgICAidGV4dC9odG1sIg0KICAgICAgICApOw0KICAgICAgfSBlbHNlIGlmICh0aGlzLnR5cGUgPT09ICJjc3YiKSB7DQogICAgICAgIHJldHVybiB0aGlzLmV4cG9ydCgNCiAgICAgICAgICB0aGlzLmpzb25Ub0NTVihqc29uKSwNCiAgICAgICAgICB0aGlzLm5hbWUucmVwbGFjZSgiLnhscyIsICIuY3N2IiksDQogICAgICAgICAgImFwcGxpY2F0aW9uL2NzdiINCiAgICAgICAgKTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB0aGlzLmV4cG9ydCgNCiAgICAgICAgdGhpcy5qc29uVG9YTFMoanNvbiksDQogICAgICAgIHRoaXMubmFtZSwNCiAgICAgICAgImFwcGxpY2F0aW9uL3ZuZC5tcy1leGNlbCINCiAgICAgICk7DQogICAgfSwNCiAgICAvKg0KCQlVc2UgZG93bmxvYWRqcyB0byBnZW5lcmF0ZSB0aGUgZG93bmxvYWQgbGluaw0KCQkqLw0KICAgIGV4cG9ydDphc3luYyBmdW5jdGlvbihkYXRhLCBmaWxlbmFtZSwgbWltZSkgew0KICAgICAgbGV0IGJsb2IgPSB0aGlzLmJhc2U2NFRvQmxvYihkYXRhLCBtaW1lKTsNCiAgICAgIGlmKHR5cGVvZiB0aGlzLmJlZm9yZUZpbmlzaCA9PT0gJ2Z1bmN0aW9uJykNCiAgICAgICAgYXdhaXQgdGhpcy5iZWZvcmVGaW5pc2goKTsNCiAgICAgIGRvd25sb2FkKGJsb2IsIGZpbGVuYW1lLCBtaW1lKTsNCiAgICB9LA0KICAgIC8qDQoJCWpzb25Ub1hMUw0KCQktLS0tLS0tLS0tLS0tLS0NCgkJVHJhbnNmb3JtIGpzb24gZGF0YSBpbnRvIGFuIHhtbCBkb2N1bWVudCB3aXRoIE1TIEV4Y2VsIGZvcm1hdCwgc2FkbHkNCgkJaXQgc2hvd3MgYSBwcm9tcHQgd2hlbiBpdCBvcGVucywgdGhhdCBpcyBhIGRlZmF1bHQgYmVoYXZpb3IgZm9yDQoJCU1pY3Jvc29mdCBvZmZpY2UgYW5kIGNhbm5vdCBiZSBhdm9pZGVkLiBJdCdzIHJlY29tbWVuZGVkIHRvIHVzZSBDU1YgZm9ybWF0IGluc3RlYWQuDQoJCSovDQogICAganNvblRvWExTKGRhdGEpIHsNCiAgICAgIGxldCB4bHNUZW1wID0NCiAgICAgICAgJzxodG1sIHhtbG5zOm89InVybjpzY2hlbWFzLW1pY3Jvc29mdC1jb206b2ZmaWNlOm9mZmljZSIgeG1sbnM6eD0idXJuOnNjaGVtYXMtbWljcm9zb2Z0LWNvbTpvZmZpY2U6ZXhjZWwiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy9UUi9SRUMtaHRtbDQwIj48aGVhZD48bWV0YSBuYW1lPVByb2dJZCBjb250ZW50PUV4Y2VsLlNoZWV0PiA8bWV0YSBuYW1lPUdlbmVyYXRvciBjb250ZW50PSJNaWNyb3NvZnQgRXhjZWwgMTEiPjxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04Ij48IS0tW2lmIGd0ZSBtc28gOV0+PHhtbD48eDpFeGNlbFdvcmtib29rPjx4OkV4Y2VsV29ya3NoZWV0cz48eDpFeGNlbFdvcmtzaGVldD48eDpOYW1lPiR7d29ya3NoZWV0fTwveDpOYW1lPjx4OldvcmtzaGVldE9wdGlvbnM+PHg6RGlzcGxheUdyaWRsaW5lcy8+PC94OldvcmtzaGVldE9wdGlvbnM+PC94OkV4Y2VsV29ya3NoZWV0PjwveDpFeGNlbFdvcmtzaGVldHM+PC94OkV4Y2VsV29ya2Jvb2s+PC94bWw+PCFbZW5kaWZdLS0+PHN0eWxlPmJyIHttc28tZGF0YS1wbGFjZW1lbnQ6IHNhbWUtY2VsbDt9PC9zdHlsZT48L2hlYWQ+PGJvZHk+PHRhYmxlPiR7dGFibGV9PC90YWJsZT48L2JvZHk+PC9odG1sPic7DQogICAgICBsZXQgeGxzRGF0YSA9ICI8dGhlYWQ+IjsNCiAgICAgIGNvbnN0IGNvbHNwYW4gPSBPYmplY3Qua2V5cyhkYXRhWzBdKS5sZW5ndGg7DQogICAgICBsZXQgX3NlbGYgPSB0aGlzOw0KDQogICAgICAvL0hlYWRlcg0KICAgICAgaWYgKHRoaXMudGl0bGUgIT0gbnVsbCkgew0KICAgICAgICB4bHNEYXRhICs9IHRoaXMucGFyc2VFeHRyYURhdGEoDQogICAgICAgICAgdGhpcy50aXRsZSwNCiAgICAgICAgICAnPHRyPjx0aCBjb2xzcGFuPSInICsgY29sc3BhbiArICciPiR7ZGF0YX08L3RoPjwvdHI+Jw0KICAgICAgICApOw0KICAgICAgfQ0KDQogICAgICAvL0ZpZWxkcw0KICAgICAgeGxzRGF0YSArPSAiPHRyPiI7DQogICAgICBmb3IgKGxldCBrZXkgaW4gZGF0YVswXSkgew0KICAgICAgICB4bHNEYXRhICs9ICI8dGg+IiArIGtleSArICI8L3RoPiI7DQogICAgICB9DQogICAgICB4bHNEYXRhICs9ICI8L3RyPiI7DQogICAgICB4bHNEYXRhICs9ICI8L3RoZWFkPiI7DQoNCiAgICAgIC8vRGF0YQ0KICAgICAgeGxzRGF0YSArPSAiPHRib2R5PiI7DQogICAgICBkYXRhLm1hcChmdW5jdGlvbihpdGVtLCBpbmRleCkgew0KICAgICAgICB4bHNEYXRhICs9ICI8dHI+IjsNCiAgICAgICAgZm9yIChsZXQga2V5IGluIGl0ZW0pIHsNCiAgICAgICAgICB4bHNEYXRhICs9ICI8dGQ+IiArIF9zZWxmLnZhbHVlUmVmb3JtYXR0ZWRGb3JNdWx0aWxpbmVzKGl0ZW1ba2V5XSkgKyAiPC90ZD4iOw0KICAgICAgICB9DQogICAgICAgIHhsc0RhdGEgKz0gIjwvdHI+IjsNCiAgICAgIH0pOw0KICAgICAgeGxzRGF0YSArPSAiPC90Ym9keT4iOw0KDQogICAgICAvL0Zvb3Rlcg0KICAgICAgaWYgKHRoaXMuZm9vdGVyICE9IG51bGwpIHsNCiAgICAgICAgeGxzRGF0YSArPSAiPHRmb290PiI7DQogICAgICAgIHhsc0RhdGEgKz0gdGhpcy5wYXJzZUV4dHJhRGF0YSgNCiAgICAgICAgICB0aGlzLmZvb3RlciwNCiAgICAgICAgICAnPHRyPjx0ZCBjb2xzcGFuPSInICsgY29sc3BhbiArICciPiR7ZGF0YX08L3RkPjwvdHI+Jw0KICAgICAgICApOw0KICAgICAgICB4bHNEYXRhICs9ICI8L3Rmb290PiI7DQogICAgICB9DQoNCiAgICAgIHJldHVybiB4bHNUZW1wLnJlcGxhY2UoIiR7dGFibGV9IiwgeGxzRGF0YSkucmVwbGFjZSgiJHt3b3Jrc2hlZXR9IiwgdGhpcy53b3Jrc2hlZXQpOw0KICAgIH0sDQogICAgLyoNCgkJanNvblRvQ1NWDQoJCS0tLS0tLS0tLS0tLS0tLQ0KCQlUcmFuc2Zvcm0ganNvbiBkYXRhIGludG8gYW4gQ1NWIGZpbGUuDQoJCSovDQogICAganNvblRvQ1NWKGRhdGEpIHsNCiAgICAgIHZhciBjc3ZEYXRhID0gW107DQogICAgICAvL0hlYWRlcg0KICAgICAgaWYgKHRoaXMudGl0bGUgIT0gbnVsbCkgew0KICAgICAgICBjc3ZEYXRhLnB1c2godGhpcy5wYXJzZUV4dHJhRGF0YSh0aGlzLnRpdGxlLCAiJHtkYXRhfVxyXG4iKSk7DQogICAgICB9DQogICAgICAvL0ZpZWxkcw0KICAgICAgZm9yIChsZXQga2V5IGluIGRhdGFbMF0pIHsNCiAgICAgICAgY3N2RGF0YS5wdXNoKGtleSk7DQogICAgICAgIGNzdkRhdGEucHVzaCgiLCIpOw0KICAgICAgfQ0KICAgICAgY3N2RGF0YS5wb3AoKTsNCiAgICAgIGNzdkRhdGEucHVzaCgiXHJcbiIpOw0KICAgICAgLy9EYXRhDQogICAgICBkYXRhLm1hcChmdW5jdGlvbihpdGVtKSB7DQogICAgICAgIGZvciAobGV0IGtleSBpbiBpdGVtKSB7DQogICAgICAgICAgbGV0IGVzY2FwZWRDU1YgPSAnPVwiJyArIGl0ZW1ba2V5XSArICdcIic7IC8vIGNhc3QgTnVtYmVycyB0byBzdHJpbmcNCiAgICAgICAgICBpZiAoZXNjYXBlZENTVi5tYXRjaCgvWywiXG5dLykpIHsNCiAgICAgICAgICAgIGVzY2FwZWRDU1YgPSAnIicgKyBlc2NhcGVkQ1NWLnJlcGxhY2UoL1wiL2csICciIicpICsgJyInOw0KICAgICAgICAgIH0NCiAgICAgICAgICBjc3ZEYXRhLnB1c2goZXNjYXBlZENTVik7DQogICAgICAgICAgY3N2RGF0YS5wdXNoKCIsIik7DQogICAgICAgIH0NCiAgICAgICAgY3N2RGF0YS5wb3AoKTsNCiAgICAgICAgY3N2RGF0YS5wdXNoKCJcclxuIik7DQogICAgICB9KTsNCiAgICAgIC8vRm9vdGVyDQogICAgICBpZiAodGhpcy5mb290ZXIgIT0gbnVsbCkgew0KICAgICAgICBjc3ZEYXRhLnB1c2godGhpcy5wYXJzZUV4dHJhRGF0YSh0aGlzLmZvb3RlciwgIiR7ZGF0YX1cclxuIikpOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIGNzdkRhdGEuam9pbigiIik7DQogICAgfSwNCiAgICAvKg0KCQlnZXRQcm9jZXNzZWRKc29uDQoJCS0tLS0tLS0tLS0tLS0tLQ0KCQlHZXQgb25seSB0aGUgZGF0YSB0byBleHBvcnQsIGlmIG5vIGZpZWxkcyBhcmUgc2V0IHJldHVybiBhbGwgdGhlIGRhdGENCgkJKi8NCiAgICBnZXRQcm9jZXNzZWRKc29uKGRhdGEsIGhlYWRlcikgew0KICAgICAgbGV0IGtleXMgPSB0aGlzLmdldEtleXMoZGF0YSwgaGVhZGVyKTsNCiAgICAgIGxldCBuZXdEYXRhID0gW107DQogICAgICBsZXQgX3NlbGYgPSB0aGlzOw0KICAgICAgZGF0YS5tYXAoZnVuY3Rpb24oaXRlbSwgaW5kZXgpIHsNCiAgICAgICAgbGV0IG5ld0l0ZW0gPSB7fTsNCiAgICAgICAgZm9yIChsZXQgbGFiZWwgaW4ga2V5cykgew0KICAgICAgICAgIGxldCBwcm9wZXJ0eSA9IGtleXNbbGFiZWxdOw0KICAgICAgICAgIG5ld0l0ZW1bbGFiZWxdID0gX3NlbGYuZ2V0VmFsdWUocHJvcGVydHksIGl0ZW0pOw0KICAgICAgICB9DQogICAgICAgIG5ld0RhdGEucHVzaChuZXdJdGVtKTsNCiAgICAgIH0pOw0KDQogICAgICByZXR1cm4gbmV3RGF0YTsNCiAgICB9LA0KICAgIGdldEtleXMoZGF0YSwgaGVhZGVyKSB7DQogICAgICBpZiAoaGVhZGVyKSB7DQogICAgICAgIHJldHVybiBoZWFkZXI7DQogICAgICB9DQoNCiAgICAgIGxldCBrZXlzID0ge307DQogICAgICBmb3IgKGxldCBrZXkgaW4gZGF0YVswXSkgew0KICAgICAgICBrZXlzW2tleV0gPSBrZXk7DQogICAgICB9DQogICAgICByZXR1cm4ga2V5czsNCiAgICB9LA0KICAgIC8qDQoJCXBhcnNlRXh0cmFEYXRhDQoJCS0tLS0tLS0tLS0tLS0tLQ0KCQlQYXJzZSB0aXRsZSBhbmQgZm9vdGVyIGF0dHJpYnV0ZSB0byB0aGUgY3N2IGZvcm1hdA0KCQkqLw0KICAgIHBhcnNlRXh0cmFEYXRhKGV4dHJhRGF0YSwgZm9ybWF0KSB7DQogICAgICBsZXQgcGFyc2VEYXRhID0gIiI7DQogICAgICBpZiAoQXJyYXkuaXNBcnJheShleHRyYURhdGEpKSB7DQogICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZXh0cmFEYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgcGFyc2VEYXRhICs9IGZvcm1hdC5yZXBsYWNlKCIke2RhdGF9IiwgZXh0cmFEYXRhW2ldKTsNCiAgICAgICAgfQ0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgcGFyc2VEYXRhICs9IGZvcm1hdC5yZXBsYWNlKCIke2RhdGF9IiwgZXh0cmFEYXRhKTsNCiAgICAgIH0NCiAgICAgIHJldHVybiBwYXJzZURhdGE7DQogICAgfSwNCg0KICAgIGdldFZhbHVlKGtleSwgaXRlbSkgew0KICAgICAgY29uc3QgZmllbGQgPSB0eXBlb2Yga2V5ICAgIT09ICJvYmplY3QiID8ga2V5IDoga2V5LmZpZWxkOw0KICAgICAgbGV0IGluZGV4ZXMgPSB0eXBlb2YgZmllbGQgIT09ICJzdHJpbmciID8gW10gIDogZmllbGQuc3BsaXQoIi4iKTsNCiAgICAgIGxldCB2YWx1ZSAgID0gdGhpcy5kZWZhdWx0VmFsdWU7DQogICAgDQogICAgICBpZiAoIWZpZWxkKQ0KCSAgICAgIHZhbHVlID0gaXRlbTsNCiAgICAgIGVsc2UgaWYoIGluZGV4ZXMubGVuZ3RoID4gMSApDQogICAgICAgIHZhbHVlID0gdGhpcy5nZXRWYWx1ZUZyb21OZXN0ZWRJdGVtKGl0ZW0sIGluZGV4ZXMpOw0KICAgICAgZWxzZQ0KICAgICAgICB2YWx1ZSA9IHRoaXMucGFyc2VWYWx1ZShpdGVtW2ZpZWxkXSk7DQogICAgICANCiAgICAgIGlmKCBrZXkuaGFzT3duUHJvcGVydHkoJ2NhbGxiYWNrJykpDQogICAgICAgIHZhbHVlID0gdGhpcy5nZXRWYWx1ZUZyb21DYWxsYmFjayh2YWx1ZSwga2V5LmNhbGxiYWNrKTsNCiAgICAgIA0KICAgICAgcmV0dXJuIHZhbHVlOw0KICAgIH0sDQoNCiAgICAvKg0KICAgIGNvbnZlcnQgdmFsdWVzIHdpdGggbmV3bGluZSBcbiBjaGFyYWN0ZXJzIGludG8gPGJyLz4NCiAgICAqLw0KICAgIHZhbHVlUmVmb3JtYXR0ZWRGb3JNdWx0aWxpbmVzKHZhbHVlKSB7DQogICAgICBpZiAodHlwZW9mKHZhbHVlKT09InN0cmluZyIpIHJldHVybih2YWx1ZS5yZXBsYWNlKC9cbi9pZywiPGJyLz4iKSk7DQogICAgICBlbHNlIHJldHVybih2YWx1ZSk7DQogICAgfSwNCg0KICAgIGdldFZhbHVlRnJvbU5lc3RlZEl0ZW0oaXRlbSwgaW5kZXhlcyl7DQogICAgICBsZXQgbmVzdGVkSXRlbSA9IGl0ZW07DQogICAgICBmb3IgKGxldCBpbmRleCBvZiBpbmRleGVzKSB7DQogICAgICAgIGlmKG5lc3RlZEl0ZW0pDQogICAgICAgICAgbmVzdGVkSXRlbSA9IG5lc3RlZEl0ZW1baW5kZXhdOw0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRoaXMucGFyc2VWYWx1ZShuZXN0ZWRJdGVtKTsNCiAgICB9LA0KDQogICAgZ2V0VmFsdWVGcm9tQ2FsbGJhY2soaXRlbSwgY2FsbGJhY2spew0KICAgICAgaWYodHlwZW9mIGNhbGxiYWNrICE9PSAiZnVuY3Rpb24iKQ0KICAgICAgICByZXR1cm4gdGhpcy5kZWZhdWx0VmFsdWUNCiAgICAgIGNvbnN0IHZhbHVlID0gY2FsbGJhY2soaXRlbSk7DQogICAgICByZXR1cm4gdGhpcy5wYXJzZVZhbHVlKHZhbHVlKTsNCiAgICB9LA0KICAgIHBhcnNlVmFsdWUodmFsdWUpew0KICAgICAgcmV0dXJuIHZhbHVlIHx8IHZhbHVlID09PSAwIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nDQogICAgICAgICAgPyB2YWx1ZQ0KICAgICAgICAgIDogdGhpcy5kZWZhdWx0VmFsdWU7DQogICAgfSwNCiAgICBiYXNlNjRUb0Jsb2IoZGF0YSwgbWltZSkgew0KICAgICAgbGV0IGJhc2U2NCA9IHdpbmRvdy5idG9hKHdpbmRvdy51bmVzY2FwZShlbmNvZGVVUklDb21wb25lbnQoZGF0YSkpKTsNCiAgICAgIGxldCBic3RyID0gYXRvYihiYXNlNjQpOw0KICAgICAgbGV0IG4gPSBic3RyLmxlbmd0aDsNCiAgICAgIGxldCB1OGFyciA9IG5ldyBVaW50OENsYW1wZWRBcnJheShuKTsNCiAgICAgIHdoaWxlIChuLS0pIHsNCiAgICAgICAgdThhcnJbbl0gPSBic3RyLmNoYXJDb2RlQXQobik7DQogICAgICB9DQogICAgICByZXR1cm4gbmV3IEJsb2IoW3U4YXJyXSwgeyB0eXBlOiBtaW1lIH0pOw0KICAgIH0NCiAgfSAvLyBlbmQgbWV0aG9kcw0KfTsNCg=="},{"version":3,"sources":["JsonExcel.vue"],"names":[],"mappings":";;;;;;;;;;;AAWA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"JsonExcel.vue","sourceRoot":"node_modules/vue-json-excel","sourcesContent":["<template>\r\n\t<div\r\n\t\t:id=\"idName\"\r\n\t\t@click=\"generate\">\r\n\t\t<slot>\r\n\t\t\tDownload {{name}}\r\n\t\t</slot>\r\n\t</div>\r\n</template>\r\n\r\n<script>\r\nimport download from \"downloadjs\";\r\n\r\nexport default {\r\n  props: {\r\n    // mime type [xls, csv]\r\n    type: {\r\n      type: String,\r\n      default: \"xls\"\r\n    },\r\n    // Json to download\r\n    data: {\r\n      type: Array,\r\n      required: false,\r\n      default: null\r\n    },\r\n    // fields inside the Json Object that you want to export\r\n    // if no given, all the properties in the Json are exported\r\n    fields: {\r\n      type: Object,\r\n      required: false\r\n    },\r\n    // this prop is used to fix the problem with other components that use the\r\n    // variable fields, like vee-validate. exportFields works exactly like fields\r\n    exportFields: {\r\n      type: Object,\r\n      required: false\r\n    },\r\n    // Use as fallback when the row has no field values\r\n    defaultValue: {\r\n      type: String,\r\n      required: false,\r\n      default: \"\"\r\n    },\r\n    // Title(s) for the data, could be a string or an array of strings (multiple titles)\r\n    title: {\r\n      default: null\r\n    },\r\n    // Footer(s) for the data, could be a string or an array of strings (multiple footers)\r\n    footer: {\r\n      default: null\r\n    },\r\n    // filename to export\r\n    name: {\r\n      type: String,\r\n      default: \"data.xls\"\r\n    },\r\n    fetch: {\r\n      type: Function,\r\n    },\r\n    meta: {\r\n      type: Array,\r\n      default: () => []\r\n    }, \r\n    worksheet: {\r\n      type: String, \r\n      default: \"Sheet1\"\r\n    },\r\n    //event before generate was called\r\n    beforeGenerate:{\r\n      type: Function,\r\n    },\r\n    //event before download pops up\r\n    beforeFinish:{\r\n      type: Function,\r\n    },\r\n  },\r\n  computed: {\r\n    // unique identifier\r\n    idName() {\r\n      var now = new Date().getTime();\r\n      return \"export_\" + now;\r\n    },\r\n\r\n    downloadFields() {\r\n      if (this.fields !== undefined) return this.fields;\r\n\r\n      if (this.exportFields !== undefined) return this.exportFields;\r\n    }\r\n  },\r\n  methods: {\r\n    async generate() {\r\n      if(typeof this.beforeGenerate === 'function'){\r\n        await this.beforeGenerate();\r\n      }\r\n      let data = this.data;\r\n      if(typeof this.fetch === 'function' || !data)\r\n         data = await this.fetch();\r\n\r\n      if (!data || !data.length) {\r\n        return;\r\n      }\r\n\r\n      let json = this.getProcessedJson(data, this.downloadFields);\r\n      if (this.type === \"html\") {\r\n        // this is mainly for testing\r\n        return this.export(\r\n          this.jsonToXLS(json),\r\n          this.name.replace(\".xls\", \".html\"),\r\n          \"text/html\"\r\n        );\r\n      } else if (this.type === \"csv\") {\r\n        return this.export(\r\n          this.jsonToCSV(json),\r\n          this.name.replace(\".xls\", \".csv\"),\r\n          \"application/csv\"\r\n        );\r\n      }\r\n      return this.export(\r\n        this.jsonToXLS(json),\r\n        this.name,\r\n        \"application/vnd.ms-excel\"\r\n      );\r\n    },\r\n    /*\r\n\t\tUse downloadjs to generate the download link\r\n\t\t*/\r\n    export:async function(data, filename, mime) {\r\n      let blob = this.base64ToBlob(data, mime);\r\n      if(typeof this.beforeFinish === 'function')\r\n        await this.beforeFinish();\r\n      download(blob, filename, mime);\r\n    },\r\n    /*\r\n\t\tjsonToXLS\r\n\t\t---------------\r\n\t\tTransform json data into an xml document with MS Excel format, sadly\r\n\t\tit shows a prompt when it opens, that is a default behavior for\r\n\t\tMicrosoft office and cannot be avoided. It's recommended to use CSV format instead.\r\n\t\t*/\r\n    jsonToXLS(data) {\r\n      let xlsTemp =\r\n        '<html xmlns:o=\"urn:schemas-microsoft-com:office:office\" xmlns:x=\"urn:schemas-microsoft-com:office:excel\" xmlns=\"http://www.w3.org/TR/REC-html40\"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content=\"Microsoft Excel 11\"><meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--><style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>';\r\n      let xlsData = \"<thead>\";\r\n      const colspan = Object.keys(data[0]).length;\r\n      let _self = this;\r\n\r\n      //Header\r\n      if (this.title != null) {\r\n        xlsData += this.parseExtraData(\r\n          this.title,\r\n          '<tr><th colspan=\"' + colspan + '\">${data}</th></tr>'\r\n        );\r\n      }\r\n\r\n      //Fields\r\n      xlsData += \"<tr>\";\r\n      for (let key in data[0]) {\r\n        xlsData += \"<th>\" + key + \"</th>\";\r\n      }\r\n      xlsData += \"</tr>\";\r\n      xlsData += \"</thead>\";\r\n\r\n      //Data\r\n      xlsData += \"<tbody>\";\r\n      data.map(function(item, index) {\r\n        xlsData += \"<tr>\";\r\n        for (let key in item) {\r\n          xlsData += \"<td>\" + _self.valueReformattedForMultilines(item[key]) + \"</td>\";\r\n        }\r\n        xlsData += \"</tr>\";\r\n      });\r\n      xlsData += \"</tbody>\";\r\n\r\n      //Footer\r\n      if (this.footer != null) {\r\n        xlsData += \"<tfoot>\";\r\n        xlsData += this.parseExtraData(\r\n          this.footer,\r\n          '<tr><td colspan=\"' + colspan + '\">${data}</td></tr>'\r\n        );\r\n        xlsData += \"</tfoot>\";\r\n      }\r\n\r\n      return xlsTemp.replace(\"${table}\", xlsData).replace(\"${worksheet}\", this.worksheet);\r\n    },\r\n    /*\r\n\t\tjsonToCSV\r\n\t\t---------------\r\n\t\tTransform json data into an CSV file.\r\n\t\t*/\r\n    jsonToCSV(data) {\r\n      var csvData = [];\r\n      //Header\r\n      if (this.title != null) {\r\n        csvData.push(this.parseExtraData(this.title, \"${data}\\r\\n\"));\r\n      }\r\n      //Fields\r\n      for (let key in data[0]) {\r\n        csvData.push(key);\r\n        csvData.push(\",\");\r\n      }\r\n      csvData.pop();\r\n      csvData.push(\"\\r\\n\");\r\n      //Data\r\n      data.map(function(item) {\r\n        for (let key in item) {\r\n          let escapedCSV = '=\\\"' + item[key] + '\\\"'; // cast Numbers to string\r\n          if (escapedCSV.match(/[,\"\\n]/)) {\r\n            escapedCSV = '\"' + escapedCSV.replace(/\\\"/g, '\"\"') + '\"';\r\n          }\r\n          csvData.push(escapedCSV);\r\n          csvData.push(\",\");\r\n        }\r\n        csvData.pop();\r\n        csvData.push(\"\\r\\n\");\r\n      });\r\n      //Footer\r\n      if (this.footer != null) {\r\n        csvData.push(this.parseExtraData(this.footer, \"${data}\\r\\n\"));\r\n      }\r\n      return csvData.join(\"\");\r\n    },\r\n    /*\r\n\t\tgetProcessedJson\r\n\t\t---------------\r\n\t\tGet only the data to export, if no fields are set return all the data\r\n\t\t*/\r\n    getProcessedJson(data, header) {\r\n      let keys = this.getKeys(data, header);\r\n      let newData = [];\r\n      let _self = this;\r\n      data.map(function(item, index) {\r\n        let newItem = {};\r\n        for (let label in keys) {\r\n          let property = keys[label];\r\n          newItem[label] = _self.getValue(property, item);\r\n        }\r\n        newData.push(newItem);\r\n      });\r\n\r\n      return newData;\r\n    },\r\n    getKeys(data, header) {\r\n      if (header) {\r\n        return header;\r\n      }\r\n\r\n      let keys = {};\r\n      for (let key in data[0]) {\r\n        keys[key] = key;\r\n      }\r\n      return keys;\r\n    },\r\n    /*\r\n\t\tparseExtraData\r\n\t\t---------------\r\n\t\tParse title and footer attribute to the csv format\r\n\t\t*/\r\n    parseExtraData(extraData, format) {\r\n      let parseData = \"\";\r\n      if (Array.isArray(extraData)) {\r\n        for (var i = 0; i < extraData.length; i++) {\r\n          parseData += format.replace(\"${data}\", extraData[i]);\r\n        }\r\n      } else {\r\n        parseData += format.replace(\"${data}\", extraData);\r\n      }\r\n      return parseData;\r\n    },\r\n\r\n    getValue(key, item) {\r\n      const field = typeof key   !== \"object\" ? key : key.field;\r\n      let indexes = typeof field !== \"string\" ? []  : field.split(\".\");\r\n      let value   = this.defaultValue;\r\n    \r\n      if (!field)\r\n\t      value = item;\r\n      else if( indexes.length > 1 )\r\n        value = this.getValueFromNestedItem(item, indexes);\r\n      else\r\n        value = this.parseValue(item[field]);\r\n      \r\n      if( key.hasOwnProperty('callback'))\r\n        value = this.getValueFromCallback(value, key.callback);\r\n      \r\n      return value;\r\n    },\r\n\r\n    /*\r\n    convert values with newline \\n characters into <br/>\r\n    */\r\n    valueReformattedForMultilines(value) {\r\n      if (typeof(value)==\"string\") return(value.replace(/\\n/ig,\"<br/>\"));\r\n      else return(value);\r\n    },\r\n\r\n    getValueFromNestedItem(item, indexes){\r\n      let nestedItem = item;\r\n      for (let index of indexes) {\r\n        if(nestedItem)\r\n          nestedItem = nestedItem[index];\r\n      }\r\n      return this.parseValue(nestedItem);\r\n    },\r\n\r\n    getValueFromCallback(item, callback){\r\n      if(typeof callback !== \"function\")\r\n        return this.defaultValue\r\n      const value = callback(item);\r\n      return this.parseValue(value);\r\n    },\r\n    parseValue(value){\r\n      return value || value === 0 || typeof value === 'boolean'\r\n          ? value\r\n          : this.defaultValue;\r\n    },\r\n    base64ToBlob(data, mime) {\r\n      let base64 = window.btoa(window.unescape(encodeURIComponent(data)));\r\n      let bstr = atob(base64);\r\n      let n = bstr.length;\r\n      let u8arr = new Uint8ClampedArray(n);\r\n      while (n--) {\r\n        u8arr[n] = bstr.charCodeAt(n);\r\n      }\r\n      return new Blob([u8arr], { type: mime });\r\n    }\r\n  } // end methods\r\n};\r\n</script>\r\n"]}]}